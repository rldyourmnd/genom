# ATF3 Promoter Transcription Factor Analysis

Набор инструментов для анализа сайтов связывания транскрипционных факторов в промоторной последовательности гена ATF3 человека.

## Назначение

Данный инструментарий разработан для:
- Идентификации потенциальных сайтов связывания транскрипционных факторов в FASTA-последовательности
- Визуализации распределения и плотности сайтов связывания
- Создания логотипов мотивов и анализа нуклеотидного состава сайтов
- Генерации комплексного отчета с результатами анализа

## Зависимости

```
biopython
pandas
numpy
matplotlib
seaborn
logomaker
pillow
```

## Структура проекта

- `Homo_sapiens_ATF3_sequence (1).fa` - FASTA-файл с промоторной последовательностью ATF3
- `tf_analysis.py` - основной скрипт анализа
- `tf_motif_visualization.py` - скрипт для создания логотипов мотивов
- `create_html_report.py` - скрипт для создания HTML-отчета
- `tf_analysis_report.md` - отчет в формате Markdown
- `tf_binding_sites_count.png` - визуализация количества сайтов связывания
- `tf_binding_sites_distribution.png` - визуализация распределения сайтов
- `tf_binding_sites_heatmap.png` - тепловая карта плотности сайтов
- `tf_logos/` - директория с логотипами мотивов
- `tf_heatmaps/` - директория с тепловыми картами частот нуклеотидов
- `tf_examples/` - директория с примерами сайтов связывания

## Описание функций

### 1. tf_analysis.py

Основной скрипт для поиска и визуализации сайтов связывания транскрипционных факторов.

Основные функции:
- `read_fasta(file_path)` - чтение FASTA-последовательности
- `find_motifs(sequence, motifs_dict)` - поиск мотивов в последовательности
- `visualize_results(motifs_results, sequence_length)` - визуализация результатов анализа

Поддерживаемые транскрипционные факторы:
- TATA-box, CAAT-box, GC-box - базовые элементы промотора
- E-box - сайты связывания bHLH-факторов
- CRE, CREB - cAMP-зависимые регуляторные элементы
- AP-1 - активаторный протеин 1
- NF-kB - ядерный фактор каппа B
- SP1 - специфический протеин 1
- GATA - факторы семейства GATA
- HRE - гормон-чувствительные элементы
- STAT - сигнальные трансдукторы и активаторы транскрипции
- NFAT - ядерный фактор активированных T-клеток
- ETS - факторы семейства ETS
- IRF - интерферон-регулирующие факторы

### 2. tf_motif_visualization.py

Скрипт для детального анализа мотивов и создания их логотипов.

Основные функции:
- `extract_binding_site_sequences(sequence, positions, site_length, context_length)` - извлечение последовательностей вокруг сайтов связывания
- `create_motif_logo(sequences, tf_name, output_dir)` - создание логотипа мотива
- `create_heatmap(matrix, tf_name, output_dir)` - создание тепловой карты частот нуклеотидов
- `save_example_sites(tf_name, sites, output_dir)` - сохранение примеров сайтов связывания

### 3. create_html_report.py

Скрипт для создания интерактивного HTML-отчета со всеми результатами анализа.

Основные функции:
- `img_to_base64(img_path)` - конвертация изображений в формат base64 для встраивания в HTML
- `load_examples(file_path)` - загрузка примеров сайтов связывания
- `create_html_report()` - создание HTML-отчета с таблицами, графиками и логотипами

## Использование

### Базовый анализ
```bash
python tf_analysis.py
```

### Создание логотипов мотивов
```bash
python tf_motif_visualization.py
```

### Генерация HTML-отчета
```bash
python create_html_report.py
```

## Результаты анализа

Основные результаты анализа промотора ATF3:

- Длина проанализированной последовательности: 57,944 нуклеотидов
- Обнаружено более 2600 потенциальных сайтов связывания транскрипционных факторов
- Наиболее представлены сайты для:
  - ETS (1268 сайтов)
  - IRF (381 сайт)
  - E-box (291 сайт)
  - NFAT (241 сайт)
  - CAAT-box (190 сайтов)
  - TATA-box (146 сайтов)
- Обнаружены классические элементы промотора (TATA-box, CAAT-box, GC-box)
- Отсутствуют сайты связывания для NF-kB, GATA и HRE

Подробные результаты представлены в файле `tf_analysis_report.html`.

## Примеры визуализаций

Примеры создаваемых визуализаций включают:
- Гистограммы количества сайтов связывания для каждого фактора
- Диаграммы распределения сайтов вдоль последовательности
- Тепловые карты плотности сайтов
- Логотипы мотивов транскрипционных факторов
- Тепловые карты частот нуклеотидов в мотивах

## Авторы

(с) 2024  