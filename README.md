# Геном - Система анализа сайтов связывания транскрипционных факторов

## Описание проекта
**Геном** - это полнофункциональный инструмент для идентификации, анализа и визуализации сайтов связывания транскрипционных факторов (ТФ) в промоторных областях генов. Система предназначена для исследователей в области молекулярной биологии, генетики и биоинформатики, позволяя выявлять потенциальные регуляторные взаимодействия между ТФ и их целевыми генами.

Программа анализирует последовательности ДНК в формате FASTA, используя мотивы из базы данных JASPAR для поиска сайтов связывания, и создает комплексные интерактивные визуализации результатов для детального изучения.

## Основные возможности

### Анализ последовательностей
- Поиск сайтов связывания ТФ в промоторных областях (-2000 до +500 от TSS)
- Анализ с использованием позиционных весовых матриц (PWM) из базы данных JASPAR
- Расчет значимости (score) и позиций сайтов связывания
- Поддержка более 20 транскрипционных факторов различных семейств

### Визуализация данных
- Интерактивная тепловая карта связывания ТФ с генами с использованием Plotly
- Статические тепловые карты и диаграммы распределения сайтов
- Детальные профили для каждого гена и ТФ с графиками и статистикой
- Цветовое кодирование интенсивности связывания для быстрой оценки

### Информационная система
- Расширенная база знаний о ТФ и генах на русском языке
- Подробная информация о функциях, семействах и сигнальных путях
- Категоризация ТФ по уровню активности (высокая, средняя, низкая)
- Связь с биологическими процессами и заболеваниями

### Интерфейс и отчеты
- Полностью русифицированный интерфейс всех компонентов
- Многостраничный HTML-отчет с навигацией между разделами
- Возможность поиска и фильтрации данных по различным параметрам
- Экспорт результатов в JSON и CSV форматы

## Установка

1. Клонируйте репозиторий:
```
git clone https://github.com/username/genom.git
cd genom
```

2. Установите необходимые зависимости:
```
pip install -r requirements.txt
```

## Требования
- Python 3.7+
- NumPy
- Pandas
- Matplotlib
- Seaborn
- Plotly
- Biopython
- JSON
- Scikit-learn (опционально)

## Использование

### Базовый анализ
```
python main.py
```
Запускает полный цикл анализа:
1. Загрузка последовательностей генов из директории `genes/`
2. Загрузка мотивов ТФ из директории `motifs/`
3. Анализ сайтов связывания для каждой пары ген-ТФ
4. Создание визуализаций и отчетов
5. Сохранение результатов в директории `results/` и `html_report/`

### Только интерактивная визуализация
```
python main.py --interactive-only
```
Создает интерактивную тепловую карту на основе существующих результатов без повторного анализа последовательностей.

### Загрузка мотивов JASPAR
```
python main.py --download-motifs
```
Загружает актуальные мотивы из базы данных JASPAR перед выполнением анализа.

### Справка по параметрам
```
python main.py --help
```

## Структура проекта

### Основные модули
- `main.py` - основной скрипт для запуска анализа и координации работы компонентов
- `simplified_binding_analysis.py` - модуль для анализа сайтов связывания ТФ в последовательностях
- `interactive_heatmap.py` - модуль для создания интерактивных тепловых карт с использованием Plotly
- `create_html_visualization.py` - генератор HTML-отчетов и визуализаций
- `tf_gene_database.py` - база знаний о транскрипционных факторах и генах

### Директории
- `genes/` - исходные FASTA-файлы с последовательностями генов
- `motifs/` - файлы с мотивами транскрипционных факторов в формате JASPAR
- `results/` - результаты анализа (JSON, CSV, PNG)
- `html_report/` - HTML-отчеты и визуализации

## Ключевые компоненты

### Анализатор сайтов связывания
Основной алгоритмический компонент системы:
- Построение PSSM (Position-Specific Scoring Matrix) на основе мотивов JASPAR
- Сканирование последовательностей ДНК с использованием скользящего окна
- Расчет нормализованных оценок связывания для каждой позиции
- Фильтрация сайтов по пороговому значению (по умолчанию 0.75)
- Обработка прямой и обратной цепей ДНК
- Детекция статистически значимых сайтов связывания

### Интерактивная тепловая карта
Динамическая визуализация результатов анализа:
- Матричное представление взаимодействий ТФ и генов
- Цветовая градация по количеству и силе сайтов связывания
- Всплывающие подсказки с детальной информацией при наведении
- Детализированное представление при клике на ячейки
- Интеграция с базой знаний о ТФ и генах
- Возможность масштабирования и экспорта визуализации

### База знаний
Структурированное хранилище информации:
- Подробные описания более 25 транскрипционных факторов
- Информация о 21 гене, включенном в анализ
- Данные о семействах ТФ и их функциональной значимости
- Описание биологических функций генов и их роли в сигнальных путях
- Взаимосвязи между ТФ, генами и биологическими процессами

### HTML-визуализация
Комплексная система отчетности:
- Главная страница с общим обзором и ключевыми показателями
- Специализированные страницы для детального анализа генов и ТФ
- Интерактивные элементы поиска и фильтрации данных
- Визуальное представление статистики и аналитики
- Профили для каждого гена и ТФ с графиками и таблицами
- Возможность сравнения и сопоставления различных данных

## Примеры аналитических задач

### Идентификация ключевых регуляторов
Выявление ТФ, наиболее активно связывающихся с промоторами исследуемых генов:
1. Просмотрите тепловую карту для общей картины связывания
2. Изучите раздел "Топ ТФ по количеству сайтов связывания"
3. Проанализируйте профили интересующих генов

### Анализ регуляторных паттернов
Выявление групп генов, регулируемых схожими наборами ТФ:
1. Используйте интерактивную тепловую карту для визуальной кластеризации
2. Сравните профили генов в разделе "Гены"
3. Исследуйте семейства ТФ и их целевые гены

### Поиск сильных сайтов связывания
Обнаружение наиболее значимых сайтов связывания для дальнейших экспериментов:
1. Изучите раздел "Самые сильные сайты связывания" на главной странице
2. Просмотрите профили интересующих ТФ для детализации
3. Анализируйте последовательности и позиции выявленных сайтов

### Функциональный анализ
Сопоставление паттернов связывания с функциональными характеристиками:
1. Изучите базу знаний о ТФ и генах
2. Сопоставьте активность ТФ с биологическими функциями
3. Анализируйте распределение ТФ по семействам и активности

## Планы развития

- Расширение базы данных ТФ и добавление новых мотивов
- Интеграция с базами данных ENCODE и ChIP-seq
- Добавление статистического анализа обогащения мотивов
- Реализация алгоритмов машинного обучения для предсказания функциональных сайтов
- Расширение аналитических возможностей интерактивных визуализаций

## Авторы и лицензия
Проект разработан для анализа регуляторных взаимодействий между транскрипционными факторами и их целевыми генами.
[MIT License](LICENSE)  